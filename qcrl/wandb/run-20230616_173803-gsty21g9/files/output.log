time taken for batch of 100 simulations + calculations: 14760.017395019531us
time taken per simulation of g + e and reward calculation: 147.6001739501953us
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
CombinedAgent                            [100, 104]                --
├─Linear: 1-1                            [100, 256]                52,480
├─ReLU: 1-2                              [100, 256]                --
├─Linear: 1-3                            [100, 256]                65,792
├─ReLU: 1-4                              [100, 256]                --
├─Linear: 1-5                            [100, 104]                26,728
├─Linear: 1-6                            [100, 104]                26,728
├─Sigmoid: 1-7                           [100, 104]                --
├─Linear: 1-8                            [100, 1]                  257
==========================================================================================
Total params: 171,985
Trainable params: 171,985
Non-trainable params: 0
Total mult-adds (M): 17.20
==========================================================================================
Input size (MB): 0.08
Forward/backward pass size (MB): 0.58
Params size (MB): 0.69
Estimated Total Size (MB): 1.35
==========================================================================================
env action space shape: (104,)
env observation space shape: (204,)

































































































































 79%|████████████████████████████████████████████████████████████████████████████████▉                     | 3176/4000 [04:47<01:14, 11.04it/s]
Traceback (most recent call last):
  File "/Users/chatt07/Desktop/shining_env/QCRL/qcrl/ppo.py", line 180, in <module>
    temp_obs, reward, terminated, truncated, info = env.step(
  File "/Users/chatt07/Desktop/shining_env/QCRL/qcrl/readout_optimisation/rl_envs/resonator_environment.py", line 175, in step
    ) = self.calculate_obs_and_reward(results)
  File "/Users/chatt07/Desktop/shining_env/QCRL/qcrl/readout_optimisation/rl_envs/resonator_environment.py", line 271, in calculate_obs_and_reward
    results_e = results[:, :, 1]
  File "/Users/chatt07/Desktop/shining_env/lib/python3.9/site-packages/jax/_src/array.py", line 317, in __getitem__
    return lax_numpy._rewriting_take(self, idx)
  File "/Users/chatt07/Desktop/shining_env/lib/python3.9/site-packages/jax/_src/numpy/lax_numpy.py", line 4105, in _rewriting_take
    if (result := _attempt_rewriting_take_via_slice(arr, idx, mode)) is not None:
  File "/Users/chatt07/Desktop/shining_env/lib/python3.9/site-packages/jax/_src/numpy/lax_numpy.py", line 4089, in _attempt_rewriting_take_via_slice
    start_indices = util.promote_dtypes(*start_indices)
  File "/Users/chatt07/Desktop/shining_env/lib/python3.9/site-packages/jax/_src/numpy/util.py", line 275, in promote_dtypes
    return [lax._convert_element_type(x, to_dtype, weak_type) for x in args]
  File "/Users/chatt07/Desktop/shining_env/lib/python3.9/site-packages/jax/_src/numpy/util.py", line 275, in <listcomp>
    return [lax._convert_element_type(x, to_dtype, weak_type) for x in args]
  File "/Users/chatt07/Desktop/shining_env/lib/python3.9/site-packages/jax/_src/lax/lax.py", line 549, in _convert_element_type
    return convert_element_type_p.bind(operand, new_dtype=new_dtype,
  File "/Users/chatt07/Desktop/shining_env/lib/python3.9/site-packages/jax/_src/core.py", line 380, in bind
    return self.bind_with_trace(find_top_trace(args), args, params)
  File "/Users/chatt07/Desktop/shining_env/lib/python3.9/site-packages/jax/_src/core.py", line 383, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
  File "/Users/chatt07/Desktop/shining_env/lib/python3.9/site-packages/jax/_src/core.py", line 790, in process_primitive
    return primitive.impl(*tracers, **params)
  File "/Users/chatt07/Desktop/shining_env/lib/python3.9/site-packages/jax/_src/dispatch.py", line 128, in apply_primitive
    from jax._src import pjit
  File "<frozen importlib._bootstrap>", line 1033, in _handle_fromlist
KeyboardInterrupt